#!/usr/bin/env perl6

use lib "{%*ENV<HOME>}/.shared-modules";
use ShopifyGit;

sub MAIN($branch-name = prompt-for-branch) {
  my $proc = run("git", "name-rev", "--name-only", "{$branch-name}@\{u}", :out, :err);
  for $proc.out.lines {
    git("branch", "-d", "--remotes", "origin/{$_}");
  }
  git("branch", "-df", $branch-name);
  git("config", "--unset", "remote.origin.fetch", Qc<^\+refs/heads/{$branch-name}:>);
}
