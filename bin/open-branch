#!/usr/bin/env perl6

use lib "{%*ENV<HOME>}/.shared-modules";
use ShopifyGit;

sub MAIN(Str $branch-arg?, Str :$remote = "origin") {
    git(<<checkout -b $branch-arg>>) if $branch-arg;
    my $branch-name = $branch-arg //
        run(<<git name-rev --name-only @>>, :out, :err).out.slurp(:close).chomp;
    add-branch-to-fetch($branch-name);
    git(<<push --set-upstream $remote $branch-name>>);
}
